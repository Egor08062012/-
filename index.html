<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∞–ø—ë—Ä PRO</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #121212;
            color: white;
            margin: 0;
            padding: 20px;
        }
        
        h1 {
            color: white;
            margin-bottom: 20px;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            width: 400px;
            margin-bottom: 10px;
            color: white;
        }
        
        .controls {
            margin-bottom: 20px;
            color: white;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        button {
            padding: 8px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        button:hover {
            background-color: #45a049;
        }
        
        button:disabled {
            background-color: #555;
            cursor: not-allowed;
        }
        
        select {
            padding: 8px;
            background-color: #333;
            color: white;
            border: 1px solid #555;
            border-radius: 4px;
        }
        
        .board {
            display: grid;
            grid-gap: 2px;
            background-color: #333;
            padding: 5px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .cell {
            width: 30px;
            height: 30px;
            background-color: #555;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            border: 2px outset #777;
            color: white;
        }
        
        .cell.revealed {
            background-color: #333;
            border: 1px solid #444;
        }
        
        .cell.mine {
            background-color: #ff0000;
        }
        
        .cell.flagged {
            background-color: #ffcc00;
        }
        
        .number-1 { color: #4fa8ff; }
        .number-2 { color: #5dff5d; }
        .number-3 { color: #ff6b6b; }
        .number-4 { color: #7b7bff; }
        .number-5 { color: #ffa347; }
        .number-6 { color: #47ffff; }
        .number-7 { color: white; }
        .number-8 { color: #c7c7c7; }
        
        .shop {
            background-color: #222;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            width: 400px;
        }
        
        .shop h2 {
            margin-top: 0;
            text-align: center;
        }
        
        .shop-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 1px solid #444;
        }
        
        .shop-item button {
            padding: 5px 10px;
            background-color: #ff9800;
        }
        
        .shop-item button:hover {
            background-color: #e68a00;
        }
        
        .money {
            color: gold;
            font-weight: bold;
        }
        
        .inventory {
            margin-top: 15px;
            background-color: #222;
            padding: 10px;
            border-radius: 8px;
        }
        
        .inventory h3 {
            margin-top: 0;
        }
        
        .inventory-item {
            display: inline-block;
            margin-right: 10px;
            background-color: #333;
            padding: 5px 10px;
            border-radius: 4px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: #222;
            padding: 20px;
            border-radius: 8px;
            width: 300px;
            text-align: center;
        }
        
        .modal button {
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <h1>–°–∞–ø—ë—Ä PRO</h1>
    
    <div class="game-info">
        <div>–ú–∏–Ω—ã: <span id="mines-count">10</span></div>
        <div>–§–ª–∞–≥–∏: <span id="flags-count">0</span></div>
        <div>–í—Ä–µ–º—è: <span id="time">0</span></div>
        <div>–î–µ–Ω—å–≥–∏: <span id="money" class="money">0</span> ‚ÇΩ</div>
    </div>
    
    <div class="controls">
        <button id="new-game">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
        <select id="difficulty">
            <option value="very-easy">–û—á–µ–Ω—å –ª–µ–≥–∫–æ (5√ó5, 3 –º–∏–Ω—ã)</option>
            <option value="easy">–õ–µ–≥–∫–æ (8√ó8, 10 –º–∏–Ω)</option>
            <option value="medium">–°—Ä–µ–¥–Ω–µ (10√ó10, 20 –º–∏–Ω)</option>
            <option value="hard">–°–ª–æ–∂–Ω–æ (16√ó16, 40 –º–∏–Ω)</option>
            <option value="expert">–≠–∫—Å–ø–µ—Ä—Ç (16√ó30, 99 –º–∏–Ω)</option>
        </select>
        <button id="open-shop">–ú–∞–≥–∞–∑–∏–Ω</button>
    </div>
    
    <div class="board" id="board"></div>
    
    <div class="inventory">
        <h3>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å:</h3>
        <div id="inventory-items">–ü—É—Å—Ç–æ</div>
    </div>
    
    <div id="shop-modal" class="modal">
        <div class="modal-content">
            <h2>–ú–∞–≥–∞–∑–∏–Ω</h2>
            <div id="shop-items"></div>
            <button id="close-shop">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>
    
    <div id="result-modal" class="modal">
        <div class="modal-content">
            <h2 id="result-title">–†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
            <p id="result-message"></p>
            <div>–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: <span id="earned-money" class="money">0</span> ‚ÇΩ</div>
            <button id="close-result">OK</button>
        </div>
    </div>
    
    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        const difficulties = {
            'very-easy': { rows: 5, cols: 5, mines: 3, reward: 50 },
            'easy': { rows: 8, cols: 8, mines: 10, reward: 100 },
            'medium': { rows: 10, cols: 10, mines: 20, reward: 200 },
            'hard': { rows: 16, cols: 16, mines: 40, reward: 500 },
            'expert': { rows: 16, cols: 30, mines: 99, reward: 1000 }
        };
        
        // –¢–æ–≤–∞—Ä—ã –≤ –º–∞–≥–∞–∑–∏–Ω–µ
        const shopItems = [
            { id: 1, name: "–ü–æ–¥—Å–∫–∞–∑–∫–∞", description: "–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—É—é –∫–ª–µ—Ç–∫—É", price: 200, use: useHint },
            { id: 2, name: "–î–µ—Ç–µ–∫—Ç–æ—Ä –º–∏–Ω", description: "–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –º–∏–Ω—ã –Ω–∞ 3 —Å–µ–∫—É–Ω–¥—ã", price: 350, use: useMineDetector },
            { id: 3, name: "–ó–∞—â–∏—Ç–∞", description: "–ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø—Ä–æ–∏–≥—Ä—ã—à–∞ 1 —Ä–∞–∑", price: 500, use: null },
            { id: 4, name: "–£–¥–≤–æ–∏—Ç–µ–ª—å", description: "–£–¥–≤–∞–∏–≤–∞–µ—Ç –Ω–∞–≥—Ä–∞–¥—É –∑–∞ —Å–ª–µ–¥—É—é—â—É—é –∏–≥—Ä—É", price: 750, use: null },
            { id: 5, name: "–í—Ä–µ–º—è+", description: "+30 —Å–µ–∫—É–Ω–¥ –∫ —Ç–∞–π–º–µ—Ä—É", price: 300, use: useTimeBonus },
            { id: 6, name: "–§–ª–∞–≥–∏+", description: "+5 —Ñ–ª–∞–≥–æ–≤", price: 250, use: useExtraFlags },
            { id: 7, name: "–°–∫–∞–Ω–µ—Ä", description: "–û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—É—é –æ–±–ª–∞—Å—Ç—å", price: 400, use: useScanner }
        ];
        
        // –ò–≥—Ä–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        let board = [];
        let revealed = [];
        let flagged = [];
        let gameOver = false;
        let firstClick = true;
        let timer = null;
        let seconds = 0;
        let currentDifficulty = 'easy';
        let rows, cols, mines;
        let money = 0;
        let inventory = [];
        let hasProtection = false;
        let doubleReward = false;
        
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const boardElement = document.getElementById('board');
        const minesCountElement = document.getElementById('mines-count');
        const flagsCountElement = document.getElementById('flags-count');
        const timeElement = document.getElementById('time');
        const moneyElement = document.getElementById('money');
        const newGameButton = document.getElementById('new-game');
        const difficultySelect = document.getElementById('difficulty');
        const openShopButton = document.getElementById('open-shop');
        const shopModal = document.getElementById('shop-modal');
        const shopItemsElement = document.getElementById('shop-items');
        const closeShopButton = document.getElementById('close-shop');
        const resultModal = document.getElementById('result-modal');
        const resultTitle = document.getElementById('result-title');
        const resultMessage = document.getElementById('result-message');
        const earnedMoneyElement = document.getElementById('earned-money');
        const closeResultButton = document.getElementById('close-result');
        const inventoryItemsElement = document.getElementById('inventory-items');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            currentDifficulty = difficultySelect.value;
            rows = difficulties[currentDifficulty].rows;
            cols = difficulties[currentDifficulty].cols;
            mines = difficulties[currentDifficulty].mines;
            
            // –û—á–∏—Å—Ç–∫–∞ –¥–æ—Å–∫–∏
            boardElement.innerHTML = '';
            boardElement.style.gridTemplateColumns = `repeat(${cols}, 30px)`;
            
            // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
            board = Array(rows).fill().map(() => Array(cols).fill(0));
            revealed = Array(rows).fill().map(() => Array(cols).fill(false));
            flagged = Array(rows).fill().map(() => Array(cols).fill(false));
            gameOver = false;
            firstClick = true;
            seconds = 0;
            timeElement.textContent = '0';
            minesCountElement.textContent = mines;
            flagsCountElement.textContent = '0';
            
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–µ—Ç–æ–∫
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    
                    cell.addEventListener('click', () => handleCellClick(i, j));
                    cell.addEventListener('contextmenu', (e) => {
                        e.preventDefault();
                        handleRightClick(i, j);
                    });
                    
                    boardElement.appendChild(cell);
                }
            }
            
            updateInventoryDisplay();
        }
        
        // –†–∞–∑–º–µ—â–µ–Ω–∏–µ –º–∏–Ω –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞
        function placeMines(firstRow, firstCol) {
            let minesPlaced = 0;
            
            while (minesPlaced < mines) {
                const row = Math.floor(Math.random() * rows);
                const col = Math.floor(Math.random() * cols);
                
                // –ù–µ —Ä–∞–∑–º–µ—â–∞–µ–º –º–∏–Ω—É –Ω–∞ –ø–µ—Ä–≤–æ–π –∫–ª–µ—Ç–∫–µ –∏ —Ç–∞–º, –≥–¥–µ —É–∂–µ –µ—Å—Ç—å –º–∏–Ω–∞
                if ((row !== firstRow || col !== firstCol) && board[row][col] !== -1) {
                    board[row][col] = -1;
                    minesPlaced++;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ —Å–æ—Å–µ–¥–Ω–∏—Ö –∫–ª–µ—Ç–æ–∫
                    for (let i = Math.max(0, row - 1); i <= Math.min(rows - 1, row + 1); i++) {
                        for (let j = Math.max(0, col - 1); j <= Math.min(cols - 1, col + 1); j++) {
                            if (board[i][j] !== -1) {
                                board[i][j]++;
                            }
                        }
                    }
                }
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –∫–ª–µ—Ç–∫–µ
        function handleCellClick(row, col) {
            if (gameOver || flagged[row][col]) return;
            
            if (firstClick) {
                firstClick = false;
                placeMines(row, col);
                startTimer();
            }
            
            if (revealed[row][col]) {
                // –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–∫—Ä—ã—Ç—å —Å–æ—Å–µ–¥–Ω–∏–µ –∫–ª–µ—Ç–∫–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –æ—Ç–∫—Ä—ã—Ç—É—é –∫–ª–µ—Ç–∫—É —Å —á–∏—Å–ª–æ–º
                if (board[row][col] > 0) {
                    chordCells(row, col);
                }
                return;
            }
            
            revealCell(row, col);
            
            if (board[row][col] === -1) {
                // –ò–≥—Ä–æ–∫ –Ω–∞—Å—Ç—É–ø–∏–ª –Ω–∞ –º–∏–Ω—É
                if (hasProtection) {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞—â–∏—Ç—É
                    hasProtection = false;
                    board[row][col] = 0;
                    revealed[row][col] = false;
                    const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
                    cell.classList.remove('mine', 'revealed');
                    cell.textContent = '';
                    updateInventoryDisplay();
                    return;
                }
                
                gameOver = true;
                revealAllMines();
                clearInterval(timer);
                showResult(false);
            } else if (checkWin()) {
                // –ò–≥—Ä–æ–∫ –ø–æ–±–µ–¥–∏–ª
                gameOver = true;
                clearInterval(timer);
                const reward = doubleReward ? difficulties[currentDifficulty].reward * 2 : difficulties[currentDifficulty].reward;
                doubleReward = false;
                money += reward;
                updateMoney();
                showResult(true, reward);
            }
        }
        
        // –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–ª–µ—Ç–∫–∏
        function revealCell(row, col) {
            if (row < 0 || row >= rows || col < 0 || col >= cols || revealed[row][col] || flagged[row][col]) {
                return;
            }
            
            revealed[row][col] = true;
            const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
            cell.classList.add('revealed');
            
            if (board[row][col] === -1) {
                cell.classList.add('mine');
                cell.textContent = 'üí£';
            } else if (board[row][col] > 0) {
                cell.textContent = board[row][col];
                cell.classList.add(`number-${board[row][col]}`);
            } else {
                // –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Å–æ—Å–µ–¥–Ω–∏–µ –ø—É—Å—Ç—ã–µ –∫–ª–µ—Ç–∫–∏
                for (let i = Math.max(0, row - 1); i <= Math.min(rows - 1, row + 1); i++) {
                    for (let j = Math.max(0, col - 1); j <= Math.min(cols - 1, col + 1); j++) {
                        if (i !== row || j !== col) {
                            revealCell(i, j);
                        }
                    }
                }
            }
        }
        
        // –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–æ—Å–µ–¥–Ω–∏—Ö –∫–ª–µ—Ç–æ–∫ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —á–∏—Å–ª–æ
        function chordCells(row, col) {
            let flagCount = 0;
            
            // –°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–ª–∞–≥–æ–≤ –≤–æ–∫—Ä—É–≥
            for (let i = Math.max(0, row - 1); i <= Math.min(rows - 1, row + 1); i++) {
                for (let j = Math.max(0, col - 1); j <= Math.min(cols - 1, col + 1); j++) {
                    if (flagged[i][j]) {
                        flagCount++;
                    }
                }
            }
            
            // –ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–ª–∞–≥–æ–≤ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —á–∏—Å–ª–æ–º, –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Å–æ—Å–µ–¥–Ω–∏–µ –∫–ª–µ—Ç–∫–∏
            if (flagCount === board[row][col]) {
                for (let i = Math.max(0, row - 1); i <= Math.min(rows - 1, row + 1); i++) {
                    for (let j = Math.max(0, col - 1); j <= Math.min(cols - 1, col + 1); j++) {
                        if (!flagged[i][j] && !revealed[i][j]) {
                            handleCellClick(i, j);
                        }
                    }
                }
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∞–≤–æ–≥–æ –∫–ª–∏–∫–∞ (—É—Å—Ç–∞–Ω–æ–≤–∫–∞/—Å–Ω—è—Ç–∏–µ —Ñ–ª–∞–≥–∞)
        function handleRightClick(row, col) {
            if (gameOver || revealed[row][col]) return;
            
            const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
            
            if (flagged[row][col]) {
                // –°–Ω–∏–º–∞–µ–º —Ñ–ª–∞–≥
                flagged[row][col] = false;
                cell.classList.remove('flagged');
                cell.textContent = '';
            } else {
                // –°—Ç–∞–≤–∏–º —Ñ–ª–∞–≥
                flagged[row][col] = true;
                cell.classList.add('flagged');
                cell.textContent = 'üö©';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —Ñ–ª–∞–≥–æ–≤
            updateFlagsCount();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ —Ñ–ª–∞–≥–æ–≤
        function updateFlagsCount() {
            let count = 0;
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (flagged[i][j]) {
                        count++;
                    }
                }
            }
            flagsCountElement.textContent = count;
        }
        
        // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
        function startTimer() {
            timer = setInterval(() => {
                seconds++;
                timeElement.textContent = seconds;
            }, 1000);
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–±–µ–¥—É
        function checkWin() {
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (board[i][j] !== -1 && !revealed[i][j]) {
                        return false;
                    }
                }
            }
            return true;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –º–∏–Ω—ã –ø—Ä–∏ –ø—Ä–æ–∏–≥—Ä—ã—à–µ
        function revealAllMines() {
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (board[i][j] === -1 && !flagged[i][j]) {
                        const cell = document.querySelector(`.cell[data-row="${i}"][data-col="${j}"]`);
                        cell.classList.add('mine', 'revealed');
                        cell.textContent = 'üí£';
                    }
                }
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–≥—Ä—ã
        function showResult(isWin, reward = 0) {
            if (isWin) {
                resultTitle.textContent = '–ü–æ–±–µ–¥–∞!';
                resultMessage.textContent = '–í—ã —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–º–∏–Ω–∏—Ä–æ–≤–∞–ª–∏ –ø–æ–ª–µ!';
                earnedMoneyElement.textContent = reward;
            } else {
                resultTitle.textContent = '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ';
                resultMessage.textContent = '–í—ã –Ω–∞—Å—Ç—É–ø–∏–ª–∏ –Ω–∞ –º–∏–Ω—É!';
                earnedMoneyElement.textContent = '0';
            }
            resultModal.style.display = 'flex';
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–µ–Ω–µ–≥
        function updateMoney() {
            moneyElement.textContent = money;
            localStorage.setItem('minesweeperMoney', money);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function updateInventoryDisplay() {
            let items = [];
            
            if (hasProtection) items.push("–ó–∞—â–∏—Ç–∞");
            if (doubleReward) items.push("–£–¥–≤–æ–∏—Ç–µ–ª—å");
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–µ–¥–º–µ—Ç—ã –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            inventory.forEach(item => {
                items.push(item.name);
            });
            
            if (items.length === 0) {
                inventoryItemsElement.textContent = "–ü—É—Å—Ç–æ";
            } else {
                inventoryItemsElement.innerHTML = items.map(item => 
                    `<div class="inventory-item">${item}</div>`
                ).join('');
            }
        }
        
        // –ü–æ–∫—É–ø–∫–∞ –ø—Ä–µ–¥–º–µ—Ç–∞
        function buyItem(itemId) {
            const item = shopItems.find(i => i.id === itemId);
            if (!item) return;
            
            if (money >= item.price) {
                money -= item.price;
                updateMoney();
                
                if (item.id === 3) { // –ó–∞—â–∏—Ç–∞
                    hasProtection = true;
                } else if (item.id === 4) { // –£–¥–≤–æ–∏—Ç–µ–ª—å
                    doubleReward = true;
                } else {
                    inventory.push(item);
                }
                
                updateInventoryDisplay();
                alert(`–í—ã –∫—É–ø–∏–ª–∏ "${item.name}"!`);
            } else {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!");
            }
        }
        
        // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞
        function useItem(itemId) {
            const itemIndex = inventory.findIndex(i => i.id === itemId);
            if (itemIndex === -1) return;
            
            const item = inventory[itemIndex];
            
            if (item.use) {
                item.use();
                inventory.splice(itemIndex, 1);
                updateInventoryDisplay();
            }
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç–æ–≤
        function useHint() {
            const safeCells = [];
            
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (!revealed[i][j] && !flagged[i][j] && board[i][j] !== -1) {
                        safeCells.push({row: i, col: j});
                    }
                }
            }
            
            if (safeCells.length > 0) {
                const randomCell = safeCells[Math.floor(Math.random() * safeCells.length)];
                const cell = document.querySelector(`.cell[data-row="${randomCell.row}"][data-col="${randomCell.col}"]`);
                cell.style.backgroundColor = '#00ff00';
                setTimeout(() => {
                    cell.style.backgroundColor = '';
                }, 3000);
            } else {
                alert("–í—Å–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç—ã!");
            }
        }
        
        function useMineDetector() {
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (board[i][j] === -1 && !flagged[i][j]) {
                        const cell = document.querySelector(`.cell[data-row="${i}"][data-col="${j}"]`);
                        cell.style.backgroundColor = '#ff0000';
                    }
                }
            }
            
            setTimeout(() => {
                for (let i = 0; i < rows; i++) {
                    for (let j = 0; j < cols; j++) {
                        if (board[i][j] === -1 && !flagged[i][j]) {
                            const cell = document.querySelector(`.cell[data-row="${i}"][data-col="${j}"]`);
                            cell.style.backgroundColor = '';
                        }
                    }
                }
            }, 3000);
        }
        
        function useTimeBonus() {
            seconds = Math.max(0, seconds - 30);
            timeElement.textContent = seconds;
        }
        
        function useExtraFlags() {
            minesCountElement.textContent = parseInt(minesCountElement.textContent) + 5;
        }
        
        function useScanner() {
            const hiddenCells = [];
            
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (!revealed[i][j] && !flagged[i][j]) {
                        hiddenCells.push({row: i, col: j});
                    }
                }
            }
            
            if (hiddenCells.length > 0) {
                const randomCell = hiddenCells[Math.floor(Math.random() * hiddenCells.length)];
                revealCell(randomCell.row, randomCell.col);
                
                if (board[randomCell.row][randomCell.col] === -1) {
                    if (hasProtection) {
                        hasProtection = false;
                        board[randomCell.row][randomCell.col] = 0;
                        revealed[randomCell.row][randomCell.col] = false;
                        const cell = document.querySelector(`.cell[data-row="${randomCell.row}"][data-col="${randomCell.col}"]`);
                        cell.classList.remove('mine', 'revealed');
                        cell.textContent = '';
                        updateInventoryDisplay();
                    } else {
                        gameOver = true;
                        revealAllMines();
                        clearInterval(timer);
                        showResult(false);
                    }
                } else if (checkWin()) {
                    gameOver = true;
                    clearInterval(timer);
                    const reward = doubleReward ? difficulties[currentDifficulty].reward * 2 : difficulties[currentDifficulty].reward;
                    doubleReward = false;
                    money += reward;
                    updateMoney();
                    showResult(true, reward);
                }
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞
        function loadShop() {
            shopItemsElement.innerHTML = shopItems.map(item => `
                <div class="shop-item">
                    <div>
                        <strong>${item.name}</strong><br>
                        <small>${item.description}</small><br>
                        –¶–µ–Ω–∞: <span class="money">${item.price}</span> ‚ÇΩ
                    </div>
                    <button onclick="buyItem(${item.id})" ${money < item.price ? 'disabled' : ''}>–ö—É–ø–∏—Ç—å</button>
                </div>
            `).join('');
            
            shopModal.style.display = 'flex';
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function initPage() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–µ–Ω–µ–≥
            const savedMoney = localStorage.getItem('minesweeperMoney');
            if (savedMoney) {
                money = parseInt(savedMoney);
                updateMoney();
            }
            
            // –°–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π
            newGameButton.addEventListener('click', initGame);
            difficultySelect.addEventListener('change', initGame);
            openShopButton.addEventListener('click', loadShop);
            closeShopButton.addEventListener('click', () => {
                shopModal.style.display = 'none';
            });
            closeResultButton.addEventListener('click', () => {
                resultModal.style.display = 'none';
            });
            
            // –ù–∞—á–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
            initGame();
        }
        
        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = initPage;
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ HTML
        window.buyItem = buyItem;
    </script>
</body>
</html>
